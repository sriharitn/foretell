% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bdw1c.R
\name{bdw1c}
\alias{bdw1c}
\title{Beta-Discrete-Weibull (BDW) survival: One-and-Done and Cure}
\usage{
bdw1c(
  surv_value,
  h,
  N0 = NULL,
  one_and_done = FALSE,
  cure = FALSE,
  starts_m = 0.6,
  starts_q = 0.1,
  starts_c = 1,
  starts_d = 0.05,
  starts_cure = 0.05,
  compute_se = TRUE,
  input = c("auto", "percent", "count"),
  percent_tol = 1e-08,
  boundary_tol = 0.001
)
}
\arguments{
\item{surv_value}{Numeric survival series (percent starting at 100, or counts).}

\item{h}{Integer forecast horizon (>= 0).}

\item{N0}{Cohort size if `input = "percent"`.}

\item{one_and_done}{Logical; include one-and-done parameter \eqn{d}.}

\item{cure}{Logical; include cure fraction parameter (fraction never churning).}

\item{starts_m, starts_q}{Starting values for \eqn{m,q} on the original scale in \eqn{(0,1)}.}

\item{starts_c}{Starting values for \eqn{c} on the original scale.}

\item{starts_d, starts_cure}{Starting values for \eqn{d} and \eqn{\pi} on the original scale in \eqn{[0,1]}.}

\item{compute_se}{Logical; compute robust SEs via Hessian + delta method.}

\item{input}{One of `"auto"`, `"percent"`, `"count"`. If `"auto"`, infer from `surv_value` and `N0`.}

\item{percent_tol, boundary_tol}{Tolerances for monotonicity checks and boundary SE skipping.}
}
\value{
An object of class `bdw_fit`.
}
\description{
Fits the Beta-Discrete-Weibull (BDW) survival model to a monotonically
nonincreasing survival series using unconstrained maximum likelihood
estimation. Internal reparameterization ensures \eqn{a>0}, \eqn{b>0}, and
\eqn{c>0} (e.g., via \eqn{\log c}), with optional one-and-done mass \eqn{d}
and cure fraction \eqn{\pi}. When \eqn{c=1}, the BDW reduces to the shifted
Beta-Geometric (sBG).
}
\details{
The baseline BDW survival (no one-and-done, no cure) at discrete times \eqn{t=0,1,\dots} is
\deqn{S(t) = \frac{B(a, b+t^{c})}{B(a,b)}.}
With one-and-done mass \eqn{d} and cure fraction \eqn{\pi}, survival for \eqn{t \ge 1} is
\deqn{S(t) = (1-d)\left[\pi + (1-\pi)\frac{B(a, b+t^{c})}{B(a,b)}\right], \qquad S(0)=1.}
Parameters \eqn{(a,b,c)} (and optionally \eqn{d,\pi}) are estimated by maximizing the
likelihood implied by the observed survival series using an internal unconstrained
parameterization. If \code{compute_se = TRUE}, standard errors on the original scale
are obtained via the delta method.
}
\examples{
\dontrun{
N0 <- 500; S <- c(100,94,90,87,85,84,83,82,81,80,79)
fit <- sbg1c(S, h=6, N0=N0, input="percent")
summary(fit)
plot(fit, scale="percent")
}

}
\references{
{Fader P, Hardie B. How to project customer retention. Journal of Interactive Marketing. 2007;21(1):76-90.}

{Fader P, Hardie B, Liu Y, Davin J, Steenburgh T. "How to Project Customer Retention" Revisited: The Role of Duration Dependence. Journal of Interactive Marketing. 2018;43:1-16.}
}
