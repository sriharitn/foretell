% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geom1c.R
\name{geom1c}
\alias{geom1c}
\title{Geometric survival: One and Done and Cure Models}
\usage{
geom1c(
  surv_value,
  h,
  N0 = NULL,
  one_and_done = FALSE,
  cure = FALSE,
  starts_p = 0.15,
  starts_d = 0.05,
  starts_cure = 0.05,
  compute_se = TRUE,
  input = c("auto", "percent", "count"),
  percent_tol = 1e-08,
  boundary_tol = 0.001
)
}
\arguments{
\item{surv_value}{Numeric survival series (percent starting at 100, or counts).}

\item{h}{Integer forecast horizon (>= 0).}

\item{N0}{Cohort size if `input="percent"`.}

\item{one_and_done}{Logical; include one-and-done parameter \eqn{d}.}

\item{cure}{Logical; include cure fraction parameter.}

\item{starts_p}{Starting values for \eqn{p} on the original scale in \eqn{(0,1)}.}

\item{starts_d, starts_cure}{Starting values for \eqn{d} and \eqn{\pi} on the original scale in \eqn{[0,1]}.}

\item{compute_se}{Logical; compute robust SEs via Hessian + delta method.}

\item{input}{One of `"auto"`, `"percent"`, `"count"`.}

\item{percent_tol, boundary_tol}{Tolerances for monotonicity and boundary SE skipping.}
}
\value{
An object of class \code{geom_fit} with the elements shown below:
\describe{
  \item{\code{y}}{Numeric vector of observed survival values on the input scale.}
  \item{\code{input}}{Character scalar, one of \code{"input"}, \code{"percent"},
    \code{"count"}, or \code{"prob"}; echoes how \code{y} was interpreted.}
  \item{\code{N0}}{Scalar. Reference cohort size used for count/percent scaling.}
  \item{\code{flags}}{Named logical vector with model switches, e.g.
    \code{c(one_and_done = TRUE/FALSE, cure = TRUE/FALSE)}.}
  \item{\code{coef_params}}{Named numeric vector of parameters on the natural scale.
    For Geom: \code{p} and optionally \code{d} (one-and-done) and \code{cure}.
    }
  \item{\code{fitted}}{Numeric vector \eqn{S(0{:}T_{\mathrm{obs}}-1)} on the probability scale; the in-sample fit.}
  \item{\code{projected}}{Numeric vector \eqn{S(0{:}T_{\mathrm{last}})} (fit + horizon) on the probability scale.}
  \item{\code{logLik}}{Maximized log-likelihood.}
  \item{\code{convergence}}{Optimizer return code (0 indicates successful convergence).}
  \item{\code{optim_out}}{Raw optimizer list (as returned by \code{optim()}); useful for debugging.}
  \item{\code{vcov_theta}}{Variance-covariance matrix on the unconstrained scale (logits).}
  \item{\code{vcov_params}}{Variance-covariance matrix for \code{coef_params} (delta-method mapped from \code{vcov_theta}).}
  \item{\code{vcov_repar}}{Variance-covariance matrix for \code{coef_repar} (e.g., \code{p}).}
  \item{\code{se_params}}{Named vector of standard errors for \code{coef_params}.}
  \item{\code{se_repar}}{Named vector of standard errors for \code{coef_repar}.}
  \item{\code{se_note}}{Character note if SEs are approximate/unstable (e.g., near-PD fix).}
}
}
\description{
Fit a geometric survival model (optionally with one-and-done and cure),
using logit parameterization, robust SEs from the Hessian,
and S3 methods for printing, summarizing, predicting, plotting.
}
\details{
Let \eqn{p \in (0,1)} be the per-period churn probability in a geometric model.
The baseline geometric survival (no one-and-done, no cure) at discrete times
\eqn{t = 0,1,\dots} is
\deqn{S(t) = (1-p)^t, \qquad S(0)=1.}
With one-and-done mass \eqn{d} and cure fraction \eqn{\pi}, survival for \eqn{t \ge 1} is
\deqn{S(t) = (1-d)\left[\pi + (1-\pi)\,(1-p)^{\,t-1}\right], \qquad S(0)=1.}

Parameters are estimated by maximizing the likelihood implied by the observed
survival series using an internal unconstrained parameterization for numerical
stability (e.g., a logit transform for \eqn{p,d,\pi}). If \code{compute_se = TRUE},
standard errors on the original scale are obtained via the delta method from
the Hessian on the working scale.
}
\examples{
\dontrun{
N0 <- 500; S <- c(100,94,90,87,85,84,83,82,81,80,79)
fit <- geom1c(S, h=6, N0=N0, input="percent")
summary(fit)
plot(fit, scale="percent")
}
}
