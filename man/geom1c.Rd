% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/geom1c.R
\name{geom1c}
\alias{geom1c}
\title{Geometric survival: One and Done and Cure Models}
\usage{
geom1c(
  surv_value,
  h,
  N0 = NULL,
  one_and_done = FALSE,
  cure = FALSE,
  starts_p = 0.15,
  starts_d = 0.05,
  starts_cure = 0.05,
  compute_se = TRUE,
  input = c("auto", "percent", "count"),
  percent_tol = 1e-08,
  boundary_tol = 0.001
)
}
\arguments{
\item{surv_value}{Numeric survival series (percent starting at 100, or counts).}

\item{h}{Integer forecast horizon (>= 0).}

\item{N0}{Cohort size if `input="percent"`.}

\item{one_and_done}{Logical; include one-and-done parameter \eqn{d}.}

\item{cure}{Logical; include cure fraction parameter.}

\item{starts_p}{Starting values for \eqn{p} on the original scale in \eqn{(0,1)}.}

\item{starts_d, starts_cure}{Starting values for \eqn{d} and \eqn{\pi} on the original scale in \eqn{[0,1]}.}

\item{compute_se}{Logical; compute robust SEs via Hessian + delta method.}

\item{input}{One of `"auto"`, `"percent"`, `"count"`.}

\item{percent_tol, boundary_tol}{Tolerances for monotonicity and boundary SE skipping.}
}
\value{
An object of class `geom_fit`.
}
\description{
Fit a geometric survival model (optionally with one-and-done and cure),
using logit parameterization, robust SEs from the Hessian,
and S3 methods for printing, summarizing, predicting, plotting.
}
\details{
Let \eqn{p \in (0,1)} be the per-period churn probability in a geometric model.
The baseline geometric survival (no one-and-done, no cure) at discrete times
\eqn{t = 0,1,\dots} is
\deqn{S(t) = (1-p)^t, \qquad S(0)=1.}
With one-and-done mass \eqn{d} and cure fraction \eqn{\pi}, survival for \eqn{t \ge 1} is
\deqn{S(t) = (1-d)\left[\pi + (1-\pi)\,(1-p)^{\,t-1}\right], \qquad S(0)=1.}

Parameters are estimated by maximizing the likelihood implied by the observed
survival series using an internal unconstrained parameterization for numerical
stability (e.g., a logit transform for \eqn{p,d,\pi}). If \code{compute_se = TRUE},
standard errors on the original scale are obtained via the delta method from
the Hessian on the working scale.
}
\examples{
\dontrun{
N0 <- 500; S <- c(100,94,90,87,85,84,83,82,81,80,79)
fit <- geom1c(S, h=6, N0=N0, input="percent")
summary(fit)
plot(fit, scale="percent")
}
}
